language: python
sudo: required
python:
  - "2.7"
  - "pypy"
env:
  - AWS_SECRET_ACCESS_KEY=fake_key AWS_ACCESS_KEY_ID=fake_id
services:
  - docker
before_install:
  - docker run -d --name dynamodb -p 0:8000 deangiberson/aws-dynamodb-local
  - export DOCKER_PORT=$(docker port dynamodb 8000 | cut -d ':' -f 2)
install: pip install -U .
script: pytest test/
after_script:
  - docker kill dynamodb
  - docker rm -f dynamodb
